{"version":3,"sources":["components/SynthControls.js","components/MaqamNoteDisplay.js","components/MaqamSynth.js","App.js","index.js"],"names":["SynthControls","_ref","currentMaqam","setCurrentMaqam","tMaqamsIntervals","rootNoteOffset","setRootNoteOffset","oscillatorType","setOscillatorType","attack","setAttack","decay","setDecay","sustain","setSustain","release","setRelease","delayAmount","setDelayAmount","delayFeedback","setDelayFeedback","reverbAmount","setReverbAmount","React","createElement","className","htmlFor","id","value","onChange","e","target","Object","keys","map","maqam","key","type","min","max","step","parseInt","name","checked","parseFloat","toFixed","Row","mappings","activeFreqs","Set","onNoteDown","onNoteUp","filter","m","freq","_ref2","idx","isActive","has","concat","onMouseDown","preventDefault","onMouseUp","onTouchStart","onTouchEnd","MaqamNoteDisplay","_ref3","upMappings","baseMappings","downMappings","UP_KEY_POOL","BASE_KEY_POOL","DOWN_KEY_POOL","Rast","Nahawand","HicazUzzalHumayun","Hicazkar","Yegah","SultaniyegahRuhnevaz","FerahnumaAskefza","Sedaraban","Huseyniasiran","Suzidil","Acemasiran","Sevkefza","Iraq","EvicSegah","Ferahnak","Evicara","Mahur","Suzidilara","Buzurk","Suzinak","ZirguleliSuzinak","Kurdilihicazkar","Nihavend","Neveser","Nikriz","HuseyniMuhayyer","GulizarBeyati","UssakAcem","Kurdi","Buselik","Arazbar","Zirgule","Sehnaz","SabaSunbule","Kucek","EskiSipihr","Dugah","Hisar","YeniSipihr","Nisaburek","Huzzam","Mustear","MayeYeniMaye","VechiArazbar","Nisabur","CargahI","CargahII","Araban","Urmawi","frequencyToNoteName","frequency","midiNote","Math","log2","roundedMidiNote","round","cents","noteName","octave","floor","abs","MaqamSynth","_tMaqamsIntervals$cur","synth","useRef","gainNode","delayEffect","reverbEffect","limiter","useState","maqamNotes","setMaqamNotes","currentMaqamScaleLength","length","setActiveFreqs","baseOctaveKeys","useMemo","slice","octaveDownKeys","octaveUpKeys","buildMappings","useCallback","octaveSlot","k","i","index","activeNotes","Map","calculateMaqamFrequencies","maqamName","rootFrequency","arguments","undefined","ratio","console","warn","maqamFrequencies","currentFreq","pow","push","fullMaqamScale","oct","forEach","sort","a","b","useEffect","current","Tone","set","wet","oscillator","envelope","chain","startAudio","state","log","document","removeEventListener","addEventListener","passive","newRootFrequency","newNotes","n","feedback","triggerAttack","prev","s","add","triggerRelease","get","delete","baseOctaveKeysLocal","octaveDownKeysLocal","octaveUpKeysLocal","handleKeyDown","toLowerCase","includes","baseKeyIndex","indexOf","absoluteNoteIndex","handleKeyUp","window","clear","App","ReactDOM","createRoot","getElementById","render","StrictMode"],"mappings":"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","file":"static/js/main.9b058f79.chunk.js","sourcesContent":["import React from 'react';\n\nconst SynthControls = ({ \n  currentMaqam, setCurrentMaqam, tMaqamsIntervals,\n  rootNoteOffset, setRootNoteOffset,\n  oscillatorType, setOscillatorType,\n  attack, setAttack, decay, setDecay, sustain, setSustain, release, setRelease,\n  delayAmount, setDelayAmount, delayFeedback, setDelayFeedback,\n  reverbAmount, setReverbAmount\n}) => {\n  return (\n    <div className=\"synth-controls-container\">\n      {/* Maqam Selection */}\n      <div className=\"control-group\">\n        <label htmlFor=\"maqam-select\">Select Maqam:</label>\n        <select\n          id=\"maqam-select\"\n          value={currentMaqam}\n          onChange={(e) => setCurrentMaqam(e.target.value)}\n        >\n          {Object.keys(tMaqamsIntervals).map((maqam) => (\n            <option key={maqam} value={maqam}>{maqam}</option>\n          ))}\n        </select>\n      </div>\n\n      {/* Root Note Offset (Octave Shift for the whole Maqam) */}\n      <div className=\"control-group\">\n        <label htmlFor=\"root-offset-slider\">Root Octave Offset:</label>\n        <input\n          id=\"root-offset-slider\"\n          type=\"range\"\n          min=\"-2\"\n          max=\"2\"\n          step=\"1\"\n          value={rootNoteOffset}\n          onChange={(e) => setRootNoteOffset(parseInt(e.target.value))}\n        />\n        <span>{rootNoteOffset}</span>\n      </div>\n\n      {/* Oscillator Type Selection */}\n      <div className=\"control-group\">\n        <label>Oscillator Type:</label>\n        <div className=\"radio-group\">\n          <input type=\"radio\" id=\"sine\" name=\"oscType\" value=\"sine\" checked={oscillatorType === 'sine'} onChange={(e) => setOscillatorType(e.target.value)} /><label htmlFor=\"sine\">Sine</label>\n          <input type=\"radio\" id=\"sawtooth\" name=\"oscType\" value=\"sawtooth\" checked={oscillatorType === 'sawtooth'} onChange={(e) => setOscillatorType(e.target.value)} /><label htmlFor=\"sawtooth\">Sawtooth</label>\n          <input type=\"radio\" id=\"triangle\" name=\"oscType\" value=\"triangle\" checked={oscillatorType === 'triangle'} onChange={(e) => setOscillatorType(e.target.value)} /><label htmlFor=\"triangle\">Triangle</label>\n          <input type=\"radio\" id=\"square\" name=\"oscType\" value=\"square\" checked={oscillatorType === 'square'} onChange={(e) => setOscillatorType(e.target.value)} /><label htmlFor=\"square\">Square</label>\n        </div>\n      </div>\n\n      {/* ADSR Controls */}\n      <div className=\"control-group adsr-controls\">\n        <h3>Envelope (ADSR)</h3>\n        <div className=\"control-item\">\n          <label htmlFor=\"attack-slider\">Attack:</label>\n          <input type=\"range\" id=\"attack-slider\" min=\"0.001\" max=\"2\" step=\"0.001\" value={attack} onChange={(e) => setAttack(parseFloat(e.target.value))} />\n          <span>{attack.toFixed(3)}s</span>\n        </div>\n        <div className=\"control-item\">\n          <label htmlFor=\"decay-slider\">Decay:</label>\n          <input type=\"range\" id=\"decay-slider\" min=\"0.01\" max=\"2\" step=\"0.01\" value={decay} onChange={(e) => setDecay(parseFloat(e.target.value))} />\n          <span>{decay.toFixed(2)}s</span>\n        </div>\n        <div className=\"control-item\">\n          <label htmlFor=\"sustain-slider\">Sustain:</label>\n          <input type=\"range\" id=\"sustain-slider\" min=\"0\" max=\"1\" step=\"0.01\" value={sustain} onChange={(e) => setSustain(parseFloat(e.target.value))} />\n          <span>{sustain.toFixed(2)}</span>\n        </div>\n        <div className=\"control-item\">\n          <label htmlFor=\"release-slider\">Release:</label>\n          <input type=\"range\" id=\"release-slider\" min=\"0.01\" max=\"3\" step=\"0.01\" value={release} onChange={(e) => setRelease(parseFloat(e.target.value))} />\n          <span>{release.toFixed(2)}s</span>\n        </div>\n      </div>\n\n      {/* Delay Control */}\n      <div className=\"control-group\">\n        <label htmlFor=\"delay-slider\">Delay (Wet Mix):</label>\n        <input\n          id=\"delay-slider\"\n          type=\"range\"\n          min=\"0\"\n          max=\"1\"\n          step=\"0.01\"\n          value={delayAmount}\n          onChange={(e) => setDelayAmount(parseFloat(e.target.value))}\n        />\n        <span>{delayAmount.toFixed(2)}</span>\n      </div>\n      <div className=\"control-group\">\n        <label htmlFor=\"delay-feedback-slider\">Delay Feedback:</label>\n        <input\n          id=\"delay-feedback-slider\"\n          type=\"range\"\n          min=\"0\"\n          max=\"0.95\"\n          step=\"0.01\"\n          value={delayFeedback}\n          onChange={(e) => setDelayFeedback(parseFloat(e.target.value))}\n        />\n        <span>{delayFeedback.toFixed(2)}</span>\n      </div>\n\n      {/* Reverb Control */}\n      <div className=\"control-group\">\n        <label htmlFor=\"reverb-slider\">Reverb (Wet Mix):</label>\n        <input\n          id=\"reverb-slider\"\n          type=\"range\"\n          min=\"0\"\n          max=\"1\"\n          step=\"0.01\"\n          value={reverbAmount}\n          onChange={(e) => setReverbAmount(parseFloat(e.target.value))}\n        />\n        <span>{reverbAmount.toFixed(2)}</span>\n      </div>\n    </div>\n  );\n};\n\nexport default SynthControls;","import React from 'react';\n\nconst Row = ({ mappings = [], activeFreqs = new Set(), onNoteDown = () => {}, onNoteUp = () => {} }) => {\n  return (\n    <div className=\"note-grid\">\n      {mappings\n        .filter(m => m && m.freq)\n        .map(({ freq, name, key }, idx) => {\n          const isActive = activeFreqs.has(freq);\n          return (\n            <span\n              key={idx}\n              className={`note-button ${isActive ? 'active' : ''}`}\n              onMouseDown={(e) => { e.preventDefault(); onNoteDown(freq, key); }}\n              onMouseUp={(e) => { e.preventDefault(); onNoteUp(key); }}\n              onTouchStart={(e) => { onNoteDown(freq, key); }}\n              onTouchEnd={(e) => { onNoteUp(key); }}\n            >\n              {name} {key ? `(${key})` : ''}\n            </span>\n          );\n        })}\n    </div>\n  );\n};\n\nconst MaqamNoteDisplay = ({ upMappings = [], baseMappings = [], downMappings = [], activeFreqs = new Set(), onNoteDown = () => {}, onNoteUp = () => {} }) => {\n  return (\n    <div className=\"note-display-section\">\n      <h2>Maqam Notes:</h2>\n      <Row mappings={upMappings} activeFreqs={activeFreqs} onNoteDown={onNoteDown} onNoteUp={onNoteUp} />\n      <Row mappings={baseMappings} activeFreqs={activeFreqs} onNoteDown={onNoteDown} onNoteUp={onNoteUp} />\n      <Row mappings={downMappings} activeFreqs={activeFreqs} onNoteDown={onNoteDown} onNoteUp={onNoteUp} />\n    </div>\n  );\n};\n\nexport default MaqamNoteDisplay;\n","import React, { useEffect, useRef, useState, useCallback } from 'react';\nimport * as Tone from 'tone';\nimport SynthControls from './SynthControls';\nimport MaqamNoteDisplay from './MaqamNoteDisplay';\nimport './MaqamSynth.css';\n\n// --- Global Maqam Data (constants) ---\nconst ROOT_FREQUENCY = 110; // Root frequency, likely A1 in Hz\nconst MICROTONAL_SIZE = 53; // Number of steps in the equal temperament system (53-TET)\nconst UP_KEY_POOL = ['q', 'w', 'e', 'r', 't', 'y', 'u', 'ı', 'o', 'p', 'ğ', 'ü'];\nconst BASE_KEY_POOL = ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'ş', 'i', ','];\nconst DOWN_KEY_POOL = ['z', 'x', 'c', 'v', 'b', 'n', 'm', 'ö', 'ç', '.'];\n\n// The dictionary of Turkish Maqams intervals in 53-TET steps\nconst tMaqamsIntervals = {\n    Rast: [9,8,5,9,9,4,4,5], Nahawand: [9,4,9,9,4,9,9], HicazUzzalHumayun: [5,12,5,9,4,4,5,9], Hicazkar: [5,12,5,9,5,3,5,4,5], Yegah: [9,8,5,9,8,4,4,5], SultaniyegahRuhnevaz: [9,4,9,9,4,9,4,5], FerahnumaAskefza: [4,9,9,9,4,9,9], Sedaraban: [5,12,5,9,5,8,4,5], Huseyniasiran: [8,5,9,8,5,9,9], Suzidil: [5,1,5,4 ,4,5,4,5], Acemasiran: [9,9,4,4,5,9,9,4], Sevkefza: [9,5,4,4,4,5,5,13,4], Iraq: [5,9,8,5,9,9,4,4],EvicSegah: [5,9,8,5,4,5,9,4,4], Ferahnak: [5,9,8,1,4,4,5,9,4, 4], Evicara: [5,13,4,9,5,13,4], Mahur: [9,9,4,9,9,4,5,4], Suzidilara: [9,5,4,4,4 ,5,9,4,5,4], Buzurk: [9,9,4,4,5,9,4,4,5], Suzinak: [5,4,4,4,5,9,4,9,9], ZirguleliSuzinak: [5,12,5,5,4,4,4,5,9], Kurdilihicazkar: [4,1,4,4,4,5,9,4,4,5], Nihavend: [9,4,9,5,4,4,5,8,5], Neveser: [9,5,12,5,5,12,5], Nikriz: [9,5,12,5,9,4 ,4,5], HuseyniMuhayyer:[8,5,9,9,4,4,5,9], GulizarBeyati: [8,5,9,5,4,4,4,5,9], UssakAcem: [8,5,9,9,4,9,9],\n    Kurdi: [4,4,1,4,9,4,5,4,9,9], Buselik: [9,4,9,5,4,4,4,5,4,5], Arazbar: [8,5,9,5,3,1,4,4,5,9],  Zirgule: [5,12,5,9,4,1,8,4,5], Sehnaz: [5,12,5,9,4,1,3,5,4,5], SabaSunbule: [8,5,5,13,4,9,9],  Kucek: [8,5,5,13,4,4,5,5,4], EskiSipihr: [8,5,5,1,3,9,4,4,5,4,5],  Dugah:[4,4,5,4,1,13,4,9,9],\n    Hisar: [8,5,9,4,5,4,1,8,4,5], YeniSipihr: [5,3,5,4,5,4,5,4,1,3,5,4,5], Nisaburek: [9,8,5,9,5,8,9], Huzzam: [5,9,5,12, 5,9,4,4], Mustear: [9,5,8,9,5,9,4,4], MayeYeniMaye: [5,9,8,1,4,9,9,8], VechiArazbar: [1,4,9,8,5,9,9,3,5], Nisabur: [8,5,9,4,9,9,4,5],  CargahI: [5,13,4,9,5,12,5], CargahII: [9,9,4,9,9,9,4], Araban: [5,8,13,5,5,8,4,5], Urmawi: [9,8,5,9,9,5,8]\n};\n\n// Helper function to convert frequency to a musical note name (e.g., A4, C#5)\n// Helper function to convert frequency to Turkish Maqam note name\nconst frequencyToNoteName = (frequency) => {\n  const A4 = 440; // A4 frequency\n  const A4_MIDI = 69; // MIDI note number for A4\n\n  // Calculate MIDI note number\n  const midiNote = 12 * (Math.log2(frequency / A4)) + A4_MIDI;\n  \n  // Round to the nearest integer for standard notes, or keep decimal for microtonal\n  const roundedMidiNote = Math.round(midiNote);\n  const cents = Math.round((midiNote - roundedMidiNote) * 100);\n\n  // Turkish note names according to Nail Yavuzoğlu's theory\n  const turkishNoteNames = [\n    \"Do\", // C\n    \"Do♯\", // C#\n    \"Re\", // D\n    \"Re♯\", // D#\n    \"Mi\", // E\n    \"Fa\", // F\n    \"Fa♯\", // F#\n    \"Sol\", // G\n    \"Sol♯\", // G#\n    \"La\", // A\n    \"La♯\", // A#\n    \"Si\"  // B\n  ];\n\n  // Special symbols for microtonal intervals\n  let noteName = turkishNoteNames[roundedMidiNote % 12];\n  const octave = Math.floor(roundedMidiNote / 12) - 1; // MIDI note 0 is C-1\n  \n  // Add microtonal symbols if needed\n  if (Math.abs(cents) > 10 && Math.abs(cents) < 90) {\n    if (cents > 0) {\n      noteName += \"↑\"; // Up arrow for slightly sharp\n    } else {\n      noteName += \"↓\"; // Down arrow for slightly flat\n    }\n  }\n\n  return `${noteName}${octave}`;\n};\n\nconst MaqamSynth = () => {\n  const synth = useRef(null);\n  const gainNode = useRef(null);\n  const delayEffect = useRef(null);\n  const reverbEffect = useRef(null);\n  const limiter = useRef(null); // Add a limiter to prevent clipping\n\n  // --- State for Synth Parameters ---\n  const [oscillatorType, setOscillatorType] = useState('sine');\n  const [attack, setAttack] = useState(0.01); // Default attack\n  const [decay, setDecay] = useState(0.2);   // Default decay\n  const [sustain, setSustain] = useState(0.5); // Default sustain\n  const [release, setRelease] = useState(1.0);  // Default release\n\n  // --- State for Effects ---\n  const [delayAmount, setDelayAmount] = useState(0);\n  const [delayFeedback, setDelayFeedback] = useState(0.5); // New: Delay Feedback\n  const [reverbAmount, setReverbAmount] = useState(0);\n\n  // --- Maqam related states ---\n  const [currentMaqam, setCurrentMaqam] = useState('Rast');\n  const [maqamNotes, setMaqamNotes] = useState([]);\n  const [rootNoteOffset, setRootNoteOffset] = useState(0);\n  const currentMaqamScaleLength = (tMaqamsIntervals[currentMaqam]?.length || 0) + 1;\n  const [activeFreqs, setActiveFreqs] = useState(new Set());\n  const baseOctaveKeys = React.useMemo(() => BASE_KEY_POOL.slice(0, currentMaqamScaleLength), [currentMaqamScaleLength]);\n  const octaveDownKeys = React.useMemo(() => DOWN_KEY_POOL.slice(0, Math.min(currentMaqamScaleLength, DOWN_KEY_POOL.length)), [currentMaqamScaleLength]);\n  const octaveUpKeys = React.useMemo(() => UP_KEY_POOL.slice(0, Math.min(currentMaqamScaleLength, UP_KEY_POOL.length)), [currentMaqamScaleLength]);\n  const buildMappings = React.useCallback((keys, octaveSlot) => keys.map((k, i) => {\n    const idx = (octaveSlot * currentMaqamScaleLength) + i;\n    const freq = maqamNotes[idx];\n    return { key: k, freq, name: freq ? frequencyToNoteName(freq) : '', index: idx };\n  }), [maqamNotes, currentMaqamScaleLength]);\n  const upMappings = React.useMemo(() => buildMappings(octaveUpKeys, 2), [octaveUpKeys, buildMappings]);\n  const baseMappings = React.useMemo(() => buildMappings(baseOctaveKeys, 1), [baseOctaveKeys, buildMappings]);\n  const downMappings = React.useMemo(() => buildMappings(octaveDownKeys, 0), [octaveDownKeys, buildMappings]);\n\n  // Keep track of currently pressed keys to handle sustained notes\n  const activeNotes = useRef(new Map()); // Map: key -> frequency\n\n  // --- Maqam Calculation Logic ---\n  const calculateMaqamFrequencies = useCallback((maqamName, rootFrequency = ROOT_FREQUENCY) => {\n    const ratio = tMaqamsIntervals[maqamName];\n\n    if (!ratio) {\n      console.warn(`Maqam \"${maqamName}\" not found in intervals dictionary.`);\n      return [];\n    }\n\n    const maqamFrequencies = [rootFrequency];\n    let currentFreq = rootFrequency;\n\n    for (let i = 0; i < ratio.length; i++) {\n      currentFreq *= Math.pow(2, (ratio[i] / MICROTONAL_SIZE));\n      maqamFrequencies.push(currentFreq);\n    }\n\n    const fullMaqamScale = [];\n    const minOctave = -1; // Go one octave down from root\n    const maxOctave = 2; // Go two octaves up from root\n\n    for (let oct = minOctave; oct <= maxOctave; oct++) {\n      maqamFrequencies.forEach(freq => {\n        fullMaqamScale.push(freq * Math.pow(2, oct));\n      });\n    }\n\n    fullMaqamScale.sort((a, b) => a - b);\n    return fullMaqamScale;\n\n  }, []);\n\n  // --- Initialize Synth and Effects ---\n  useEffect(() => {\n    if (!synth.current) {\n      // Create master gain node\n      gainNode.current = new Tone.Gain(0.5);\n\n      // Create effects\n      delayEffect.current = new Tone.FeedbackDelay(\"8n\", delayFeedback).set({ wet: 0 });\n      reverbEffect.current = new Tone.Reverb({ decay: 1.5, wet: 0.05 }).set({ wet: 0 });\n      limiter.current = new Tone.Limiter(-6); // -6 dB threshold, prevents clipping\n\n      // Chain: Synth -> Delay -> Reverb -> Limiter -> Gain -> Destination\n      synth.current = new Tone.PolySynth(Tone.Synth, {\n        oscillator: { type: oscillatorType },\n        envelope: { attack, decay, sustain, release }, // Use state variables\n      }).chain(delayEffect.current, reverbEffect.current, limiter.current, gainNode.current, Tone.Destination);\n\n      // Start Tone.js context on first user interaction\n      const startAudio = () => {\n        if (Tone.context.state !== 'running') {\n          Tone.start();\n          console.log('Audio context started.');\n        }\n        document.removeEventListener('keydown', startAudio);\n        document.removeEventListener('click', startAudio);\n        document.removeEventListener('touchstart', startAudio);\n      };\n      document.addEventListener('keydown', startAudio);\n      document.addEventListener('click', startAudio);\n      document.addEventListener('touchstart', startAudio, { passive: true });\n    }\n  }, []); // Empty dependency array: runs only once on mount\n\n  // --- Update Maqam Notes ---\n  useEffect(() => {\n    const newRootFrequency = ROOT_FREQUENCY * Math.pow(2, rootNoteOffset);\n    const newNotes = calculateMaqamFrequencies(currentMaqam, newRootFrequency);\n    setMaqamNotes(newNotes);\n    console.log(`Maqam: ${currentMaqam}, Root Freq: ${newRootFrequency}, Notes:`, newNotes.map(n => n.toFixed(2)));\n  }, [currentMaqam, rootNoteOffset, calculateMaqamFrequencies]);\n\n  // --- Update Synth Parameters (ADSR, Oscillator Type) ---\n  useEffect(() => {\n    if (synth.current) {\n      synth.current.set({\n        oscillator: { type: oscillatorType },\n        envelope: { attack, decay, sustain, release },\n      });\n    }\n  }, [oscillatorType, attack, decay, sustain, release]);\n\n  // --- Update Delay Effect ---\n  useEffect(() => {\n    if (delayEffect.current) {\n      delayEffect.current.wet.value = delayAmount;\n      delayEffect.current.feedback.value = delayFeedback;\n    }\n  }, [delayAmount, delayFeedback]);\n\n  // --- Update Reverb Effect ---\n  useEffect(() => {\n    if (reverbEffect.current) {\n      reverbEffect.current.wet.value = reverbAmount;\n    }\n  }, [reverbAmount]);\n\n  // --- Play/Release Notes ---\n  const triggerAttack = useCallback((frequency, key) => {\n    if (synth.current && !activeNotes.current.has(key)) {\n      synth.current.triggerAttack(frequency);\n      activeNotes.current.set(key, frequency);\n      setActiveFreqs(prev => {\n        const s = new Set(prev);\n        s.add(frequency);\n        return s;\n      });\n    }\n  }, []);\n\n  const triggerRelease = useCallback((key) => {\n    if (synth.current && activeNotes.current.has(key)) {\n      const frequency = activeNotes.current.get(key);\n      synth.current.triggerRelease(frequency);\n      activeNotes.current.delete(key);\n      setActiveFreqs(prev => {\n        const s = new Set(prev);\n        s.delete(frequency);\n        return s;\n      });\n    }\n  }, []);\n\n  // --- Keyboard Event Listeners ---\n  useEffect(() => {\n    const baseOctaveKeysLocal = baseOctaveKeys;\n    const octaveDownKeysLocal = octaveDownKeys;\n    const octaveUpKeysLocal = octaveUpKeys;\n\n    const handleKeyDown = (e) => {\n      const key = e.key.toLowerCase();\n      // Only process keys if they are part of our synth mapping\n      if (![...baseOctaveKeysLocal, ...octaveDownKeysLocal, ...octaveUpKeysLocal].includes(key)) {\n        return;\n      }\n      e.preventDefault(); // Prevent default browser actions for synth keys\n\n      let baseKeyIndex = -1;\n      let octaveSlot = -1; // -1 for octave down keys, 0 for base keys, 1 for octave up keys (relative to fullMaqamScale generation)\n\n      if (baseOctaveKeysLocal.includes(key)) {\n        baseKeyIndex = baseOctaveKeysLocal.indexOf(key);\n        octaveSlot = 1; // Corresponds to the *second* octave generated in fullMaqamScale (index 1)\n      } else if (octaveDownKeysLocal.includes(key)) {\n        baseKeyIndex = octaveDownKeysLocal.indexOf(key);\n        octaveSlot = 0; // Corresponds to the *first* octave generated in fullMaqamScale (index 0)\n      } else if (octaveUpKeysLocal.includes(key)) {\n        baseKeyIndex = octaveUpKeysLocal.indexOf(key);\n        octaveSlot = 2; // Corresponds to the *third* octave generated in fullMaqamScale (index 2)\n      }\n\n      if (baseKeyIndex !== -1 && maqamNotes.length > 0) {\n        const absoluteNoteIndex = (octaveSlot * currentMaqamScaleLength) + baseKeyIndex;\n\n        if (absoluteNoteIndex >= 0 && absoluteNoteIndex < maqamNotes.length) {\n          triggerAttack(maqamNotes[absoluteNoteIndex], key);\n        } else {\n          console.warn(`Key \"${key}\" maps to an out-of-bounds note index: ${absoluteNoteIndex}. Maqam notes length: ${maqamNotes.length}. Current Maqam Scale Length: ${currentMaqamScaleLength}`);\n        }\n      }\n    };\n\n    const handleKeyUp = (e) => {\n      const key = e.key.toLowerCase();\n      // Only process keys if they are part of our synth mapping\n      if (![...baseOctaveKeys, ...octaveDownKeys, ...octaveUpKeys].includes(key)) {\n        return;\n      }\n      e.preventDefault(); // Prevent default browser actions\n      triggerRelease(key);\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    window.addEventListener('keyup', handleKeyUp);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n      window.removeEventListener('keyup', handleKeyUp);\n      activeNotes.current.clear();\n      setActiveFreqs(new Set());\n    };\n  }, [maqamNotes, currentMaqam, triggerAttack, triggerRelease, currentMaqamScaleLength, baseOctaveKeys, octaveDownKeys, octaveUpKeys]);\n\n  return (\n    <div className=\"maqam-synth-container\">\n      <h1>Turkish Maqam Synthesizer</h1>\n      <SynthControls\n        currentMaqam={currentMaqam}\n        setCurrentMaqam={setCurrentMaqam}\n        tMaqamsIntervals={tMaqamsIntervals}\n        rootNoteOffset={rootNoteOffset}\n        setRootNoteOffset={setRootNoteOffset}\n        oscillatorType={oscillatorType}\n        setOscillatorType={setOscillatorType}\n        attack={attack}\n        setAttack={setAttack}\n        decay={decay}\n        setDecay={setDecay}\n        sustain={sustain}\n        setSustain={setSustain}\n        release={release}\n        setRelease={setRelease}\n        delayAmount={delayAmount}\n        setDelayAmount={setDelayAmount}\n        delayFeedback={delayFeedback}\n        setDelayFeedback={setDelayFeedback}\n        reverbAmount={reverbAmount}\n        setReverbAmount={setReverbAmount}\n      />\n      <MaqamNoteDisplay \n        upMappings={upMappings}\n        baseMappings={baseMappings}\n        downMappings={downMappings}\n        activeFreqs={activeFreqs}\n        onNoteDown={(freq, key) => triggerAttack(freq, key)}\n        onNoteUp={(key) => triggerRelease(key)}\n      />\n    </div>\n  );\n};\n\nexport default MaqamSynth;\n","// src/App.js\nimport React from 'react';\nimport './App.css';\n\nimport MaqamSynth from './components/MaqamSynth'; // <--- Make sure this import is here\n\nfunction App() {\n  return (\n    <div>\n      <MaqamSynth /> {/* <--- Make sure this component is rendered here */}\n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);"],"sourceRoot":""}